# 逃逸分析

逃逸分析是一种确定指针动态范围的静态分析，它可以分析在程序的哪些地方可以访问到指针。

在JVM的即时编译语境下，逃逸分析将判断新建的对象是否逃逸。即时编译器判断对象是否逃逸的依据，一是对象是否被存入堆中（静态字段或者堆中对象的实例字段），二是对象是否被传人未知代码中。

## 基于逃逸分析的优化

即时编译器可以根据逃逸分析的结果进行诸如锁消除、栈上分配以及标量替换的优化。后者指的是将原本连续分配的对象拆散为一个个单独的字段，分布在栈上或者寄存器中。

如果即时编译器能够证明锁对象不逃逸，那么该锁对象的加锁、解锁操作没有意义。这是因为其它线程并不能获得该锁对象，因此也不可能对其加锁。在这种情况下，即时编译器可以消除对该不逃逸对象的加锁、解锁操作。

## 部分逃逸分析

部分逃逸分析将根据控制流信息，判断出新建对象仅在部分分支中逃逸，并且将对象的新建操作推延至对象逃逸的分支中。这将使得原本因对象逃逸而无法避免的新建对象操作，不再出现在只执行if-else分支的程序路径之中。
