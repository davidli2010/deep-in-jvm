# Java对象的内存布局

## 压缩指针

在JVM中，每个Java对象都有一个对象头（object header），这个由标记字段和类型指针所构成。其中，标记字段用以存储JVM有关该对象的运行数据，如hashcode、GC信息以及锁信息，而类型指针则指向该对象的类。

在64位的JVM中，对象头的标记字段占64位，而类型指针又占了64位。也就是说，每一个Java对象在内存中的额外开销就是16个字节。

为了尽量减少对象的内存使用量，64位JVM引入了压缩指针的概念，将堆中原本64位的Java对象指针压缩成32位的。

## 字段重排列

顾名思义，JVM重新分配字段的先后顺序，以达到内存对齐的目的。

Java 8还引入了一个新的注解@Contented，用来解决对象字段之间的虚共享（false sharing）问题。这个注解也会影响到字段的排列。
